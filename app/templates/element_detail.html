<!-- Fixed Element Detail Sidebar -->
<div class="fixed top-0 left-0 h-screen w-96 bg-white shadow-lg border-r border-gray-200 overflow-hidden"
     x-show="true">
    <div class="h-full flex flex-col">
        <!-- Header -->
        <div class="px-4 py-5 bg-gray-50 border-b border-gray-200">
            <div class="flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-900">
                    Element Details
                </h3>
                {% if element %}
                <span class="text-sm text-gray-500">ID: {{ element.id }}</span>
                {% endif %}
            </div>
        </div>

        <!-- Content -->
        <div class="flex-1 overflow-y-auto p-4">
            {% if element %}
            <dl class="space-y-6">
                <!-- Element Type -->
                <div>
                    <dt class="text-sm font-medium text-gray-500">Element Type</dt>
                    <dd class="mt-1 text-sm text-gray-900">{{ element.name }}</dd>
                </div>

                <!-- XPath -->
                <div>
                    <dt class="text-sm font-medium text-gray-500">XPath</dt>
                    <dd class="mt-1 text-sm text-gray-900 break-all font-mono bg-gray-50 p-2 rounded">
                        {{ element.xpath }}
                    </dd>
                </div>

                <!-- Classes -->
                <div>
                    <dt class="text-sm font-medium text-gray-500">Classes</dt>
                    <dd class="mt-1 text-sm text-gray-900">
                        {% if element.classes %}
                        <div class="flex flex-wrap gap-2">
                            {% for class in element.classes %}
                            <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
                                {{ class }}
                            </span>
                            {% endfor %}
                        </div>
                        {% else %}
                        <span class="text-gray-400">No classes</span>
                        {% endif %}
                    </dd>
                </div>

                <!-- Attributes -->
                <div>
                    <dt class="text-sm font-medium text-gray-500">Attributes</dt>
                    <dd class="mt-1 text-sm text-gray-900">
                        {% if element.attributes %}
                        <div class="space-y-2">
                            {% for attr, value in element.attributes.items() %}
                            <div class="flex items-start">
                                <span class="font-mono text-gray-600">{{ attr }}</span>
                                <span class="mx-2">=</span>
                                <span class="font-mono text-gray-800 break-all bg-gray-50 px-2 rounded flex-1">{{ value }}</span>
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                        <span class="text-gray-400">No attributes</span>
                        {% endif %}
                    </dd>
                </div>

                <!-- Content Preview -->
                <div>
                    <dt class="text-sm font-medium text-gray-500">Content Preview</dt>
                    <dd class="mt-1 text-sm text-gray-900 break-words">{{ element.content }}</dd>
                </div>
            </dl>
            {% else %}
            <p class="text-gray-500 text-sm">Select an element to view its details</p>
            {% endif %}
        </div>

        <!-- Save Button -->
        {% if element %}
        <div class="border-t p-4 bg-gray-50">
            <form hx-post="/save" 
                  hx-swap="none"
                  hx-on::after-request="handleSaveResponse(event.detail.xhr)">
                <input type="hidden" name="element-data" value="{{ element|tojson }}" />
                <button type="submit"
                    class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                >
                    Save Element
                </button>
            </form>
            <div id="save-status" class="mt-2 text-sm text-center"></div>
        </div>
        {% endif %}
    </div>
</div>

<script>
function handleSaveResponse(xhr) {
    const status = document.getElementById('save-status');
    try {
        const response = JSON.parse(xhr.responseText);
        status.textContent = response.message;
        status.className = `mt-2 text-sm text-center ${response.status === 'success' ? 'text-green-600' : 'text-red-600'}`;
        if (response.status === 'success') {
            setTimeout(() => {
                status.textContent = '';
            }, 3000);
        }
    } catch (e) {
        status.textContent = 'Error saving element';
        status.className = 'mt-2 text-sm text-center text-red-600';
    }
}
</script> 